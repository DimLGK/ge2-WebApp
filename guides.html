<!DOCTYPE html>
<html lang="en">

<head>
  <title>Tour Explorations</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

  <!-- Firebase JS SDK region -->
  <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-database.js"></script>

  <!-- Style region -->
  <link rel="stylesheet" type="text/css" href="./style.css" />

  <script src="./database.js"></script>
</head>

<body id="myPage" data-spy="scroll" data-target=".navbar" data-offset="60">

  <!-- Configuration Firebase -->
  <script>
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    var firebaseConfig = {
      apiKey: "AIzaSyD_xg06CLNiORbmfVO-6vURoADclO1g2eo",
      authDomain: "tourexploration.firebaseapp.com",
      databaseURL: "https://tourexploration.firebaseio.com",
      projectId: "tourexploration",
      storageBucket: "tourexploration.appspot.com",
      messagingSenderId: "115899410318",
      appId: "1:115899410318:web:49b5df20824212d6d6a6df",
      measurementId: "G-EMZ6NWJ72Y"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
   
    $(document).ready(function () {
      var markersRef = firebase.database().ref('guides'); 
      markersRef.on('value', snapshot => {
        //$("#table").remove();
        snapshot.forEach(function(childSnapshot) {
          var childData = childSnapshot.val();

          tr = $('<tr id=childData.uid/>');
          tr.append("<td>" + childData.name + "</td>");
          tr.append("<td>" + childData.specialization + "</td>");
          tr.append("<td>" + childData.languages + "</td>");
          tr.append("<td>" + childData.occupation + "</td>");
          tr.append("<td>" + childData.payment + "</td>");
          tr.append('<td><button type="button" class="btn btn-danger" onclick="deleteGuideFromDb(\'' + childData.uid + '\')">X</button></td>');
          //tr.append("<td>" + "<button " + "type=" + "button " + "class=" + "btn btn-danger" + " onclick=" + "deleteGuideFromDb(" + childData.uid + ")" + ">X</button>" + "</td>");
          $('table').append(tr);
       });     
     });
    });

    var pmData = [
      {
        "name": "Χριστίνα Βασιλειάδη",
        "message": "Ο πελάτης θα περιμένει στην Καμάρα στις 10:00."
      }
    ];

  </script>


  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#myPage">Tour Explorations</a>
      </div>
      <div class="collapse navbar-collapse" id="myNavbar">
        <ul class="nav navbar-nav navbar-right">
          <li><a href="index.html">ΑΡΧΙΚΗ</a></li>
          <li><a href="guides.html">ΔΙΑΧΕΙΡΙΣΗ ΞΕΝΑΓΩΝ</a></li>
          <li><a href="routes.html">ΠΡΟΤΕΙΝΟΜΕΝΕΣ ΔΙΑΔΡΟΜΕΣ</a></li>
          <li><a href="requests.html">ΑΙΤΗΜΑΤΑ</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="col-md-2">
    <div class="sidenav">
      <a style="font-family: Montserrat, sans-serif; font-size: 15px !important;" href="#christina"
        onclick="showChat()">
        <img style="display: inline-block; width: 40px; height: 40px; border-radius: 50%; overflow: hidden;"
          src="https://i2-prod.mirror.co.uk/incoming/article14334083.ece/ALTERNATES/s615/3_Beautiful-girl-with-a-gentle-smile.jpg" />
        Χριστίνα Βασιλειάδη</a>
      <a style="font-family: Montserrat, sans-serif; font-size: 15px !important;" href="#tony" onclick="showChat()">
        <img style="display: inline-block; width: 40px; height: 40px; border-radius: 50%; overflow: hidden;"
          src="https://icdn2.digitaltrends.com/image/digitaltrends/screen-shot-2019-02-15-at-19-16-58.jpg" />
        Tony Chan</a>
      <a style="font-family: Montserrat, sans-serif; font-size: 15px !important;" href="#hasan" onclick="showChat()">
        <img style="display: inline-block; width: 40px; height: 40px; border-radius: 50%; overflow: hidden;"
          src="https://biographicsworld.com/wp-content/uploads/2020/07/Hasan-Piker.png" />
        Hasan Abdul</a>
    </div>
  </div>

  <div class="col-md-10" style="top: 7rem;">
    <div class="">
      <table id="table" class="table table-striped table-hover">
        <thead>
          <tr>
            <th>Ονοματεπώνυμο</th>
            <th>Ειδίκευση</th>
            <th>Γλώσσες</th>
            <th>Επάγγελμα</th>
            <th>Χρέωση</th>
            <th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- Κουμπί προσθήκης ξεναγού -->
    <button class="open-button" style="position: fixed; bottom: 23px; right: 28px;" onclick="showAddGuideForm()">Προσθήκη
      νέου ξεναγού</button>

  </div>
  
  <!-- Φόρμα προσθήκης ξεναγού -->
  <!-- Employee Form -->
  <div class="modal"
    style="display: none; position: fixed; width: 40rem; bottom: 0; right: 0; border: 3px solid #f1f1f1; z-index: 9;"
    id="employeeForm">
    <form class="form-container">

      <label for="employeeForm"><b>Προσθήκη νέου ξεναγού</b></label>

      <div class="col">
        <div class="form-group">
          <label for="name">Ονοματεπώνυμο</label>
          <input type="text" class="form-control" id="name" aria-describedby="nameHelp" placeholder="Ονοματεπώνυμο">
        </div>
        <div class="form-group">
          <label for="specialization">Ειδίκευση</label>
          <input type="text" class="form-control" id="specialization" placeholder="Ειδίκευση">
        </div>
      </div>
      <div class="col">
        <div class="form-group">
          <label for="languages">Γλώσσες</label>
          <input type="text" class="form-control" id="languages" placeholder="Γλώσσες">
        </div>
        <div class="form-group">
          <label for="occupation">Επάγγελμα</label>
          <input type="text" class="form-control" id="occupation" placeholder="Επάγγελμα">
        </div>
      </div>
      <div class="col">
        <div class="form-group">
          <label for="payment">Χρέωση</label>
          <input type="text" class="form-control" id="payment" placeholder="Χρέωση">
        </div>
      </div>

      <button id="but1" type="button" class="btn btn-primary" onclick="addGuide()">Προσθήκη</button>
      <button type="button" class="btn cancel" onclick="closeAddGuideForm()">Κλείσιμο</button>
    </form>
  </div>

  <!-- Φόρμα συνομιλίας με ξεναγό -->
  <!-- Chat -->
  <div class="chat-popup" id="chat">
    <form class="form-container">

      <label for="msg"><b>Μήνυμα</b></label>
      <textarea placeholder="Type message.." name="msg" required></textarea>

      <button type="submit" class="btn">Αποστολή</button>
      <button type="button" class="btn cancel" onclick="closeChat()">Κλείσιμο</button>
    </form>
  </div>
  
  <script>
    // Open Chat Popup
    function showChat() {
      document.getElementById("chat").style.display = "block";
    }

    // Close Chat Popup
    function closeChat() {
      document.getElementById("chat").style.display = "none";
    }

    // Open Add Guide Form
    function showAddGuideForm() {
      document.getElementById("employeeForm").style.display = "block";
    }
    
    // Add the Guide to Db
    function addGuide() {
      var name = (document.getElementById('name')).value;
      var specialization = (document.getElementById('specialization')).value;
      var languages = (document.getElementById('languages')).value;
      var occupation = (document.getElementById('occupation')).value;
      var payment = (document.getElementById('payment')).value;
      console.log(name + " " + specialization + " " + languages + " " + occupation + " " + payment + "\n");
      saveGuideToDb(name, payment, 10, occupation, languages, specialization);
      closeAddGuideForm();
    }

    // Close the Popup Add Guide Form
    function closeAddGuideForm() {
      document.getElementById("employeeForm").style.display = "none";
    }

  </script>

</body>

</html>
